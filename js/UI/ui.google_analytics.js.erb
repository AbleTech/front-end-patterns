// Requires ../lib/window.do_not_track.js
// Requires ./_ui.js
(function(w,d,UI){

	var googleAnalytics = function(){
		var uiga = this;

		uiga.addScript = function(){
			(function(i,s,o,g,r,a,m){
				i['GoogleAnalyticsObject']=r;
				i[r]=i[r]||function(){
					(i[r].q=i[r].q||[]).push(arguments);
				},
				i[r].l=1*new Date();
				a=s.createElement(o),
				m=s.getElementsByTagName(o)[0];
				a.async=1;
				a.src=g;
				m.parentNode.insertBefore(a,m);
			})(w,d,'script','https://www.google-analytics.com/analytics.js','ga');
			uiga.startGA();
		};

		uiga.startGA = function(){
			w.ga('create', '<%= ApplicationConfig::GoogleAnalytics::TRACKING_KEY %>', 'auto');
			w.ga('send', 'pageview');
		};

		if (DNT() != 1) {
			uiga.addScript();
		}

		return uiga;
	}

	UI.GoogleAnalytics = googleAnalytics;

})(window, document, UI);
